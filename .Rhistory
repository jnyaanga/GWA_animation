aes(x = allele, y = value) +
geom_point(position = ggbeeswarm::position_beeswarm(), shape = 21) +
guides(fill = "none") +
geom_boxplot(alpha = 0.4) +
theme(legend.position = "bottom") +
labs(x = "Genotype", y = "Trait Value", title = "Progress: {frame} of {nframes}") +
facet_wrap(. ~ POS) +
scale_y_continuous(limits = c(-3.5,3.5)) +
scale_x_discrete(breaks = c("REF", "ALT")) #+
all_data %>%
dplyr::filter(CHROM %in% c("IV")) %>%
dplyr::filter(POS %in% c(ch4[850:896])) %>%
ggplot() +
theme_bw() +
aes(x = allele, y = value) +
geom_point(position = ggbeeswarm::position_beeswarm(), shape = 21) +
guides(fill = "none") +
geom_boxplot(alpha = 0.4) +
theme(legend.position = "bottom") +
labs(x = "Genotype", y = "Trait Value", title = "Progress: {frame} of {nframes}") +
facet_wrap(. ~ POS) +
scale_y_continuous(limits = c(-3.5,3.5)) +
scale_x_discrete(breaks = c("REF", "ALT")) #+
all_data %>%
dplyr::filter(CHROM %in% c("IV")) %>%
dplyr::filter(POS %in% c(ch4[896:898])) %>%
ggplot() +
theme_bw() +
aes(x = allele, y = value) +
geom_point(position = ggbeeswarm::position_beeswarm(), shape = 21) +
guides(fill = "none") +
geom_boxplot(alpha = 0.4) +
theme(legend.position = "bottom") +
labs(x = "Genotype", y = "Trait Value", title = "Progress: {frame} of {nframes}") +
facet_wrap(. ~ POS) +
scale_y_continuous(limits = c(-3.5,3.5)) +
scale_x_discrete(breaks = c("REF", "ALT")) #+
problem<- list(2.773807)
problem<- c(2.773807)
all_data %>%
dplyr::filter(CHROM %in% c("IV")) %>%
dplyr::filter(POS %in% c(ch4[898:905])) %>%
ggplot() +
theme_bw() +
aes(x = allele, y = value) +
geom_point(position = ggbeeswarm::position_beeswarm(), shape = 21) +
guides(fill = "none") +
geom_boxplot(alpha = 0.4) +
theme(legend.position = "bottom") +
labs(x = "Genotype", y = "Trait Value", title = "Progress: {frame} of {nframes}") +
facet_wrap(. ~ POS) +
scale_y_continuous(limits = c(-3.5,3.5)) +
scale_x_discrete(breaks = c("REF", "ALT")) #+
all_data %>% dplyr::filter(CHROM == "IV", sig == "BF")
all_data %>% dplyr::filter(CHROM == "IV", sig == "BF") %>% unique(Position)
all_data %>% dplyr::filter(CHROM == "IV", sig == "BF") %>% unique(POS)
all_data %>% dplyr::filter(CHROM == "IV", sig == "BF") %>% unique(POS)
all_data %>% dplyr::filter(CHROM == "IV", sig == "BF") %>% distinct(POS)
problem <- c(2.773807, 2.987421, 3.115342, 3.160159, 3.233147, 3.370982)
all_data %>%
dplyr::filter(CHROM %in% c("IV")) %>%
dplyr::filter(POS %in% c(problem)) %>%
ggplot() +
theme_bw() +
aes(x = allele, y = value) +
geom_point(position = ggbeeswarm::position_beeswarm(), shape = 21) +
guides(fill = "none") +
geom_boxplot(alpha = 0.4) +
theme(legend.position = "bottom") +
labs(x = "Genotype", y = "Trait Value", title = "Progress: {frame} of {nframes}") +
facet_wrap(. ~ POS) +
scale_y_continuous(limits = c(-3.5,3.5)) +
scale_x_discrete(breaks = c("REF", "ALT")) #+
View(processed_mapping)
View(processed_mapping)
b <- processed_mapping %>% dplyr::filter(CHROM == "IV") %>% dplyr::group_by(POS) %>% dplyr::summarize(n = n())
View(b)
bb <- all_data %>% dplyr::filter(CHROM == "IV") %>% dplyr::group_by(POS) %>% dplyr::summarize(n = n())
View(bb)
b <- processed_mapping %>% dplyr::filter(CHROM == "IV", POS == 2.773807)
b2 <- processed_mapping %>% dplyr::filter(CHROM == "IV", POS == 0.0484)
View(b2)
b2 <- processed_mapping %>% dplyr::filter(CHROM == "IV", POS == 17.48907)
View(b)
View(bb)
b2 <- processed_mapping %>% dplyr::filter(CHROM == "IV", POS == 0.048435)
View(b2)
b2 <- processed_mapping %>% dplyr::filter(CHROM == "IV", POS == 0.049409)
View(b2)
# load data for manhattan plot --> ie. marker information
processed_mapping2 <- read.delim("processed_Cry5B_inbred.tsv", stringsAsFactors=FALSE) %>%
dplyr::mutate(CHROM = factor(CHROM, levels = c("I","II","III","IV","V","X","MtDNA"))) %>%
dplyr::select(-marker) %>%
tidyr::unite("marker", CHROM, POS, sep = ":", remove = F) %>%
dplyr::mutate(POS = POS/1000000) %>%
dplyr::select(marker:aboveBF) %>%
dplyr::distinct()
View(processed_mapping2)
b1 <- processed_mapping2 %>% dplyr::filter(CHROM == "IV", POS == 2.773807)
View(b1)
# load data for manhattan plot --> ie. marker information
processed_mapping <- read.delim("processed_Cry5B_inbred.tsv", stringsAsFactors=FALSE) %>%
dplyr::mutate(CHROM = factor(CHROM, levels = c("I","II","III","IV","V","X","MtDNA"))) %>%
dplyr::select(-marker) %>%
tidyr::unite("marker", CHROM, POS, sep = ":", remove = F) %>%
dplyr::mutate(POS = POS/1000000) %>%
dplyr::select(marker:aboveBF) %>%
dplyr::distinct()
# load strain data for each marker
genotype_matrix <- read.delim("Genotype_Matrix.tsv", stringsAsFactors=FALSE) %>%
dplyr::mutate(CHROM = factor(CHROM, levels = c("I","II","III","IV","V","X","MtDNA"))) %>%
tidyr::unite("marker", CHROM, POS, sep = ":", remove = F) %>%
dplyr::mutate(POS = POS/1000000) %>%
tidyr::pivot_longer(cols = AB1:XZ2018,
names_to = "strain",
values_to = "allele") %>%
dplyr::mutate(allele = dplyr::case_when(allele == "-1" ~ "REF",
allele == "1" ~ "ALT",
TRUE ~ "NA"),
allele = factor(allele, levels = c("REF", "ALT")))
# load phenotype data for each strain
phenotypes <- read.delim("phenotypes.tsv", stringsAsFactors=FALSE) %>%
dplyr::rename(value = Cry5B) %>%
dplyr::left_join(genotype_matrix, ., by = "strain")
# clean up marker data and set significance threshold as BF
BF <- processed_mapping %>%
dplyr::group_by(trait) %>%
dplyr::filter(log10p != 0) %>%
dplyr::distinct(marker, log10p) %>%
dplyr::mutate(BF = -log10(0.05/sum(log10p > 0, na.rm = T))) %>%
dplyr::ungroup() %>%
dplyr::select(BF) %>%
unique(.) %>%
dplyr::slice(1) %>% # BF can be slightly different between loco and inbred... but just plot one (5.46 v 5.47...)
as.numeric()
BF.frame <- processed_mapping %>%
dplyr::select(trait) %>%
dplyr::filter(!duplicated(trait)) %>%
dplyr::mutate(BF = BF)
# combine all data
all_data <- processed_mapping %>%
dplyr::inner_join(., phenotypes, by = c("marker", "CHROM", "POS")) %>%
dplyr::mutate(sig = case_when(log10p > BF.frame$BF ~ "BF", TRUE ~ "NONSIG"),
strain = as.factor(strain))
sig.colors <- c("red","black")
names(sig.colors) <- c("BF","NONSIG")
facet_scales <- "free"
all_data %>%
dplyr::select(-c(REF:value)) %>%
unique() %>%
dplyr::filter(CHROM %in% c("IV")) %>%
ggplot() +
theme_bw() +
aes(group = POS) +
geom_point(mapping = aes(x = POS, y = log10p, color = sig, alpha = sig)) +
scale_alpha_manual(values = c("BF" = 1,  "user" = 1, "NONSIG" = 0.25)) +
scale_colour_manual(values = sig.colors) +
scale_x_continuous(expand = c(0, 0), breaks = c(5, 10, 15, 20)) +
scale_y_continuous(limits = c(0,7.5)) +
geom_hline(yintercept = 5.47) +
scale_linetype_manual(values = c("BF" = 1)) +
labs(x = "", y = expression(-log[10](italic(p))), title = "Progress: {frame} of {nframes}") +
theme(legend.position = "none", panel.grid = element_blank()) +
facet_grid(. ~ CHROM, scales = "free_x", space = facet_scales)
library(tidyverse)
library(glue)
library(gganimate)
library(ggbeeswarm)
all_data %>%
dplyr::filter(CHROM %in% c("IV")) %>%
dplyr::filter(POS %in% c(problem)) %>%
ggplot() +
theme_bw() +
aes(x = allele, y = value) +
geom_point(position = ggbeeswarm::position_beeswarm(), shape = 21) +
guides(fill = "none") +
geom_boxplot(alpha = 0.4) +
theme(legend.position = "bottom") +
labs(x = "Genotype", y = "Trait Value", title = "Progress: {frame} of {nframes}") +
facet_wrap(. ~ POS) +
scale_y_continuous(limits = c(-3.5,3.5)) +
scale_x_discrete(breaks = c("REF", "ALT")) #+
problem <- c(2.773807, 2.987421, 3.115342, 3.160159, 3.233147, 3.370982)
all_data %>%
dplyr::filter(CHROM %in% c("IV")) %>%
dplyr::filter(POS %in% c(problem)) %>%
ggplot() +
theme_bw() +
aes(x = allele, y = value) +
geom_point(position = ggbeeswarm::position_beeswarm(), shape = 21) +
guides(fill = "none") +
geom_boxplot(alpha = 0.4) +
theme(legend.position = "bottom") +
labs(x = "Genotype", y = "Trait Value", title = "Progress: {frame} of {nframes}") +
facet_wrap(. ~ POS) +
scale_y_continuous(limits = c(-3.5,3.5)) +
scale_x_discrete(breaks = c("REF", "ALT")) #+
all_data %>%
dplyr::filter(CHROM %in% c("IV")) %>%
dplyr::filter(POS %in% c(problem))
all_data %>%
dplyr::filter(CHROM %in% c("IV")) %>%
dplyr::filter(POS %in% c(problem)) %>%
ggplot() +
theme_bw() +
aes(x = allele, y = value) +
geom_point(position = ggbeeswarm::position_beeswarm(), shape = 21) +
geom_boxplot(aes(fill = sig), alpha = 0.4) +
scale_fill_manual(values = sig.colors) +
guides(fill = "none") +
theme(legend.position = "bottom") +
labs(x = "Genotype", y = "Trait Value", title = "Progress: {frame} of {nframes}") +
facet_wrap(. ~ POS) +
scale_y_continuous(limits = c(-3.5,3.5)) +
scale_x_discrete(breaks = c("REF", "ALT")) #+
all_data %>%
dplyr::filter(CHROM %in% c("IV")) %>%
dplyr::filter(POS %in% c(problem)) %>%
ggplot() +
theme_bw() +
aes(x = allele, y = value) +
geom_point(position = ggbeeswarm::position_beeswarm(), shape = 21) +
geom_boxplot(aes(color = sig), alpha = 0.4) +
scale_color_manual(values = sig.colors) +
guides(color = "none") +
theme(legend.position = "bottom") +
labs(x = "Genotype", y = "Trait Value", title = "Progress: {frame} of {nframes}") +
facet_wrap(. ~ POS) +
scale_y_continuous(limits = c(-3.5,3.5)) +
scale_x_discrete(breaks = c("REF", "ALT")) #+
# pxg
chrIVpxg <- all_data %>%
dplyr::filter(CHROM %in% c("IV")) %>%
ggplot() +
theme_bw() +
aes(x = allele, y = value) +
geom_point(position = ggbeeswarm::position_beeswarm(), shape = 21) +
geom_boxplot(aes(color = sig), alpha = 0.4) +
scale_color_manual(values = sig.colors) +
guides(color = "none") +
theme(legend.position = "bottom") +
labs(x = "Genotype", y = "Trait Value", title = "Progress: {frame} of {nframes}") +
facet_grid(. ~ CHROM) +
scale_y_continuous(limits = c(-3.5,3.5)) +
scale_x_discrete(breaks = c("REF", "ALT")) +
transition_manual(POS)
animate(chrIVpxg, nframes=200, fps=10, duration = 20, renderer = gifski_renderer(loop = F, width = 400, height = 400))
problem
prob <- c(2.766510, problem)
prob
all_data %>%
dplyr::filter(CHROM %in% c("IV")) %>%
dplyr::filter(POS %in% c(prob)) %>%
ggplot() +
theme_bw() +
aes(x = allele, y = value) +
geom_point(position = ggbeeswarm::position_beeswarm(), shape = 21) +
geom_boxplot(aes(color = sig), alpha = 0.4) +
scale_color_manual(values = sig.colors) +
guides(color = "none") +
theme(legend.position = "bottom") +
labs(x = "Genotype", y = "Trait Value", title = "Progress: {frame} of {nframes}") +
facet_wrap(. ~ POS) +
scale_y_continuous(limits = c(-3.5,3.5)) +
scale_x_discrete(breaks = c("REF", "ALT")) #+
# pxg
chrIVpxg <- all_data %>%
dplyr::filter(CHROM %in% c("IV")) %>%
ggplot() +
theme_bw() +
aes(x = allele, y = value) +
geom_point(position = ggbeeswarm::position_beeswarm(), shape = 21) +
geom_boxplot(aes(color = sig), alpha = 0.4) +
scale_color_manual(values = sig.colors) +
guides(color = "none") +
theme(legend.position = "bottom") +
labs(x = "Genotype", y = "Trait Value", title = "Progress: {frame} of {nframes}") +
facet_grid(. ~ CHROM) +
scale_y_continuous(limits = c(-3.5,3.5)) +
scale_x_discrete(breaks = c("REF", "ALT")) +
transition_manual(POS)
animate(chrIVpxg, nframes=500, fps=10, duration = 50, renderer = gifski_renderer(loop = F, width = 400, height = 400))
# pxg
chrIVpxg <- all_data %>%
dplyr::filter(CHROM %in% c("IV")) %>%
dplyr::filter(POS %in% c(prob)) %>%
ggplot() +
theme_bw() +
aes(x = allele, y = value) +
geom_point(position = ggbeeswarm::position_beeswarm(), shape = 21) +
geom_boxplot(aes(color = sig), alpha = 0.4) +
scale_color_manual(values = sig.colors) +
guides(color = "none") +
theme(legend.position = "bottom") +
labs(x = "Genotype", y = "Trait Value", title = "Progress: {frame} of {nframes}") +
facet_grid(. ~ CHROM) +
scale_y_continuous(limits = c(-3.5,3.5)) +
scale_x_discrete(breaks = c("REF", "ALT")) +
transition_manual(POS)
all_data %>%
dplyr::filter(CHROM %in% c("IV")) %>%
dplyr::filter(POS %in% c(prob)) %>%
ggplot() +
theme_bw() +
aes(x = allele, y = value) +
geom_point(position = ggbeeswarm::position_beeswarm(), shape = 21) +
geom_boxplot(aes(color = sig), alpha = 0.4) +
scale_color_manual(values = sig.colors) +
guides(color = "none") +
theme(legend.position = "bottom") +
labs(x = "Genotype", y = "Trait Value", title = "Progress: {frame} of {nframes}") +
facet_grid(. ~ CHROM) +
scale_y_continuous(limits = c(-3.5,3.5)) +
scale_x_discrete(breaks = c("REF", "ALT")) +
transition_manual(POS)
all_data %>%
dplyr::filter(CHROM %in% c("IV")) %>%
dplyr::filter(POS %in% c(2:4)) %>%
ggplot() +
theme_bw() +
aes(x = allele, y = value) +
geom_point(aes(color = sig), position = ggbeeswarm::position_beeswarm(), shape = 21) +
geom_boxplot(aes(color = sig), alpha = 0.4) +
scale_color_manual(values = sig.colors) +
guides(color = "none") +
theme(legend.position = "bottom") +
labs(x = "Genotype", y = "Trait Value", title = "Progress: {frame} of {nframes}") +
facet_grid(. ~ CHROM) +
scale_y_continuous(limits = c(-3.5,3.5)) +
scale_x_discrete(breaks = c("REF", "ALT")) +
transition_manual(POS)
all_data %>%
dplyr::filter(CHROM %in% c("IV")) %>%
dplyr::filter(POS %in% c(prob)) %>%
ggplot() +
theme_bw() +
aes(x = allele, y = value) +
geom_point(aes(color = sig), position = ggbeeswarm::position_beeswarm(), shape = 21) +
geom_boxplot(aes(color = sig), alpha = 0.4) +
scale_color_manual(values = sig.colors) +
guides(color = "none") +
theme(legend.position = "bottom") +
labs(x = "Genotype", y = "Trait Value", title = "Progress: {frame} of {nframes}") +
facet_grid(. ~ CHROM) +
scale_y_continuous(limits = c(-3.5,3.5)) +
scale_x_discrete(breaks = c("REF", "ALT")) +
transition_manual(POS)
frame_vars()
all_data %>%
dplyr::filter(CHROM %in% c("IV")) %>%
ggplot() +
theme_bw() +
aes(x = allele, y = value) +
geom_point(aes(color = sig), position = ggbeeswarm::position_beeswarm(), shape = 21) +
geom_boxplot(aes(color = sig), alpha = 0.4) +
scale_color_manual(values = sig.colors) +
guides(color = "none") +
theme(legend.position = "bottom") +
labs(x = "Genotype", y = "Trait Value", title = "Progress: {frame} of {nframes}") +
facet_grid(. ~ CHROM) +
scale_y_continuous(limits = c(-3.5,3.5)) +
scale_x_discrete(breaks = c("REF", "ALT")) +
transition_manual(POS)
length(frame_vars())
frame_vars()
length(frame_vars())
nrow(frame_vars())
nframes
nframes()
frame_vars()$nframes
frame_vars()$nframes[1]
# pxg
chrIVpxg <- all_data %>%
dplyr::filter(CHROM %in% c("IV")) %>%
ggplot() +
theme_bw() +
aes(x = allele, y = value) +
geom_point(aes(color = sig), position = ggbeeswarm::position_beeswarm(), shape = 21) +
geom_boxplot(aes(color = sig), alpha = 0.4) +
scale_color_manual(values = sig.colors) +
guides(color = "none") +
theme(legend.position = "bottom") +
labs(x = "Genotype", y = "Trait Value", title = "Progress: {frame} of {nframes}") +
facet_grid(. ~ CHROM) +
scale_y_continuous(limits = c(-3.5,3.5)) +
scale_x_discrete(breaks = c("REF", "ALT")) +
transition_manual(POS)
animate(chrIVpxg, nframes=frame_vars()$nframes[1], fps=10, duration = 30, renderer = gifski_renderer(loop = F, width = 400, height = 400))
animate(chrIVpxg, nframes=frame_vars()$nframes[1], fps=1, duration = 60, renderer = gifski_renderer(loop = F, width = 400, height = 400))
animate(chrIVpxg, nframes=frame_vars()$nframes[1], fps=10, renderer = gifski_renderer(loop = F, width = 400, height = 400))
# pxg
chrIpxg <- all_data %>%
#dplyr::filter(CHROM %in% c("I")) %>%
ggplot() +
theme_bw() +
aes(x = allele, y = value) +
geom_point(aes(color = sig), position = ggbeeswarm::position_beeswarm(), shape = 21) +
geom_boxplot(aes(color = sig), alpha = 0.4) +
scale_color_manual(values = sig.colors) +
guides(color = "none") +
theme(legend.position = "bottom") +
labs(x = "Genotype", y = "Trait Value", title = "Progress: {frame} of {nframes}") +
facet_grid(. ~ CHROM) +
scale_y_continuous(limits = c(-3.5,3.5)) +
scale_x_discrete(breaks = c("REF", "ALT")) +
transition_manual(POS)
animate(chrIpxg, nframes=200, duration = 20, fps=10, renderer = gifski_renderer(loop = F, width = 400, height = 400))
all_data %>%
dplyr::filter(CHROM %in% c("III")) %>%
ggplot() +
theme_bw() +
aes(x = allele, y = value) +
geom_point(aes(color = sig), position = ggbeeswarm::position_beeswarm(), shape = 21) +
geom_boxplot(aes(color = sig), alpha = 0.4) +
scale_color_manual(values = sig.colors) +
guides(color = "none") +
theme(legend.position = "bottom") +
labs(x = "Genotype", y = "Trait Value", title = "Progress: {frame} of {nframes}") +
facet_grid(. ~ CHROM) +
scale_y_continuous(limits = c(-3.5,3.5)) +
scale_x_discrete(breaks = c("REF", "ALT")) +
transition_manual(POS)
# phenotype x genotype
chrIpxg <- all_data %>%
dplyr::filter(CHROM %in% c("IV")) %>%
ggplot() +
theme_bw() +
aes(x = allele, y = value) +
geom_point(aes(color = sig), position = ggbeeswarm::position_beeswarm(), shape = 21) +
geom_boxplot(aes(color = sig), alpha = 0.4) +
scale_color_manual(values = sig.colors) +
guides(color = "none") +
theme(legend.position = "bottom") +
labs(x = "Genotype", y = "Trait Value", title = "Progress: {frame} of {nframes}") +
facet_grid(. ~ CHROM) +
scale_y_continuous(limits = c(-3.5,3.5)) +
scale_x_discrete(breaks = c("REF", "ALT")) +
transition_manual(POS)
animate(chrIpxg, nframes=200, duration = 20, fps=10, renderer = gifski_renderer(loop = F, width = 400, height = 400))
# phenotype x genotype
chrIpxg <- all_data %>%
dplyr::filter(CHROM %in% c("X")) %>%
ggplot() +
theme_bw() +
aes(x = allele, y = value) +
geom_point(aes(color = sig), position = ggbeeswarm::position_beeswarm(), shape = 21) +
geom_boxplot(aes(color = sig), alpha = 0.4) +
scale_color_manual(values = sig.colors) +
guides(color = "none") +
theme(legend.position = "bottom") +
labs(x = "Genotype", y = "Trait Value", title = "Progress: {frame} of {nframes}") +
facet_grid(. ~ CHROM) +
scale_y_continuous(limits = c(-3.5,3.5)) +
scale_x_discrete(breaks = c("REF", "ALT")) +
transition_manual(POS)
animate(chrIpxg, nframes=200, duration = 20, fps=10, renderer = gifski_renderer(loop = F, width = 400, height = 400))
# manhattan
chrI <- all_data %>%
dplyr::select(-c(REF:value)) %>%
unique() %>%
dplyr::filter(CHROM %in% c("I")) %>%
ggplot() +
theme_bw() +
aes(group = POS) +
geom_point(mapping = aes(x = POS, y = log10p, color = sig, alpha = sig)) +
scale_alpha_manual(values = c("BF" = 1,  "user" = 1, "NONSIG" = 0.25)) +
scale_colour_manual(values = sig.colors) +
scale_x_continuous(expand = c(0, 0), breaks = c(5, 10, 15, 20)) +
scale_y_continuous(limits = c(0,7.5)) +
geom_hline(yintercept = 5.47) +
scale_linetype_manual(values = c("BF" = 1)) +
labs(x = "", y = expression(-log[10](italic(p))), title = "Progress: {frame} of {nframes}") +
theme(legend.position = "none", panel.grid = element_blank()) +
facet_grid(. ~ CHROM, scales = "free_x", space = facet_scales) +
transition_reveal(POS) +
shadow_trail(future = F, alpha = alpha*2, size = size/10, distance = 0.01)
animate(chrI, nframes=200, fps=10, duration = 20, renderer = gifski_renderer(loop = F, width = 800, height = 1200))
anim_save("ChrI_man.gif")
# phenotype x genotype
chrIpxg <- all_data %>%
dplyr::filter(CHROM %in% c("X")) %>%
ggplot() +
theme_bw() +
aes(x = allele, y = value) +
geom_point(aes(color = sig), position = ggbeeswarm::position_beeswarm(), shape = 21) +
geom_boxplot(aes(color = sig), alpha = 0.4) +
scale_color_manual(values = sig.colors) +
guides(color = "none") +
theme(legend.position = "bottom") +
labs(x = "Genotype", y = "Trait Value", title = "Progress: {frame} of {nframes}") +
facet_grid(. ~ CHROM) +
scale_y_continuous(limits = c(-3.5,3.5)) +
scale_x_discrete(breaks = c("REF", "ALT")) +
transition_manual(POS)
# phenotype x genotype
chrIpxg <- all_data %>%
dplyr::filter(CHROM %in% c("I")) %>%
ggplot() +
theme_bw() +
aes(x = allele, y = value) +
geom_point(aes(color = sig), position = ggbeeswarm::position_beeswarm(), shape = 21) +
geom_boxplot(aes(color = sig), alpha = 0.4) +
scale_color_manual(values = sig.colors) +
guides(color = "none") +
theme(legend.position = "bottom") +
labs(x = "Genotype", y = "Trait Value", title = "Progress: {frame} of {nframes}") +
facet_grid(. ~ CHROM) +
scale_y_continuous(limits = c(-3.5,3.5)) +
scale_x_discrete(breaks = c("REF", "ALT")) +
transition_manual(POS)
animate(chrIpxg, nframes=200, duration = 20, fps=10, renderer = gifski_renderer(loop = F, width = 400, height = 400))
anim_save("ChrI_pxg.gif")
