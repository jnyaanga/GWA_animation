IVsub %>%
ggplot() +
theme_bw() +
aes(group = POS) +
geom_point(mapping = aes(x = POS, y = log10p, color = sig, alpha = sig)) +
scale_alpha_manual(values = c("BF" = 1,  "user" = 1, "NONSIG" = 0.25)) +
scale_colour_manual(values = sig.colors) +
scale_x_continuous(expand = c(0, 0), breaks = c(5, 10, 15, 20)) +
scale_y_continuous(limits = c(0,7.5)) +
geom_hline(yintercept = 5.47, linetype = "dashed") +
scale_linetype_manual(values = c("BF" = 1)) +
labs(x = "Genomic Position (Mb)", y = expression(-log[10](italic(p)))) +
#labs(title = "Progress: {frame} of {nframes}") +
theme(legend.position = "none", panel.grid = element_blank()) +
facet_grid(. ~ CHROM, scales = "free_x", space = facet_scales)
IVsub <- read_csv("sample_data.csv") %>%
dplyr::group_by(marker,CHROM,POS,A1,A2,AF1,BETA,SE,P,log10p,trait,BF,aboveBF,sig)%>%
nest() %>%
ungroup()
IVsub %>%
ggplot() +
theme_bw() +
aes(group = POS) +
geom_point(mapping = aes(x = POS, y = log10p, color = sig, alpha = sig)) +
scale_alpha_manual(values = c("BF" = 1,  "user" = 1, "NONSIG" = 0.25)) +
scale_colour_manual(values = sig.colors) +
scale_x_continuous(expand = c(0, 0), breaks = c(5, 10, 15, 20)) +
scale_y_continuous(limits = c(0,7.5)) +
geom_hline(yintercept = 5.47, linetype = "dashed") +
scale_linetype_manual(values = c("BF" = 1)) +
labs(x = "Genomic Position (Mb)", y = expression(-log[10](italic(p)))) +
#labs(title = "Progress: {frame} of {nframes}") +
theme(legend.position = "none", panel.grid = element_blank()) +
facet_grid(. ~ CHROM, scales = "free_x", space = facet_scales)
IVsub %>%
ggplot() +
theme_bw() +
aes(group = POS) +
geom_point(mapping = aes(x = POS, y = log10p, color = sig, alpha = sig)) +
scale_alpha_manual(values = c("BF" = 1,  "user" = 1, "NONSIG" = 0.25)) +
scale_colour_manual(values = sig.colors) +
scale_x_continuous(expand = c(0, 0), breaks = c(5, 10, 15)) +
scale_y_continuous(limits = c(0,7.5)) +
geom_hline(yintercept = 5.47, linetype = "dashed") +
scale_linetype_manual(values = c("BF" = 1)) +
labs(x = "Genomic Position (Mb)", y = expression(-log[10](italic(p)))) +
#labs(title = "Progress: {frame} of {nframes}") +
theme(legend.position = "none", panel.grid = element_blank()) +
facet_grid(. ~ CHROM, scales = "free_x", space = facet_scales)
IVsub %>%
ggplot() +
theme_bw() +
aes(group = POS) +
geom_point(mapping = aes(x = POS, y = log10p, color = sig, alpha = sig)) +
scale_alpha_manual(values = c("BF" = 1,  "user" = 1, "NONSIG" = 0.25)) +
scale_colour_manual(values = sig.colors) +
scale_x_continuous(expand = c(0, 0), breaks = c(5, 10, 15), limits = c(0,16)) +
scale_y_continuous(limits = c(0,7.5)) +
geom_hline(yintercept = 5.47, linetype = "dashed") +
scale_linetype_manual(values = c("BF" = 1)) +
labs(x = "Genomic Position (Mb)", y = expression(-log[10](italic(p)))) +
#labs(title = "Progress: {frame} of {nframes}") +
theme(legend.position = "none", panel.grid = element_blank()) +
facet_grid(. ~ CHROM, scales = "free_x", space = facet_scales)
IVsub <- read_csv("sample_data.csv") %>%
dplyr::group_by(marker,CHROM,POS,A1,A2,AF1,BETA,SE,P,log10p,trait,BF,aboveBF,sig)%>%
nest() %>%
ungroup()
IVsub %>%
ggplot() +
theme_bw() +
aes(group = POS) +
geom_point(mapping = aes(x = POS, y = log10p, color = sig, alpha = sig)) +
scale_alpha_manual(values = c("BF" = 1,  "user" = 1, "NONSIG" = 0.25)) +
scale_colour_manual(values = sig.colors) +
scale_x_continuous(expand = c(0, 0), breaks = c(5, 10, 15), limits = c(0,16)) +
scale_y_continuous(limits = c(0,7.5)) +
geom_hline(yintercept = 5.47, linetype = "dashed") +
scale_linetype_manual(values = c("BF" = 1)) +
labs(x = "Genomic Position (Mb)", y = expression(-log[10](italic(p)))) +
#labs(title = "Progress: {frame} of {nframes}") +
theme(legend.position = "none", panel.grid = element_blank()) +
facet_grid(. ~ CHROM, scales = "free_x", space = facet_scales)
IVsub %>%
ggplot() +
theme_bw() +
aes(group = POS) +
geom_point(mapping = aes(x = POS, y = log10p, color = sig, alpha = sig)) +
scale_alpha_manual(values = c("BF" = 1,  "user" = 1, "NONSIG" = 0.25)) +
scale_colour_manual(values = sig.colors) +
scale_x_continuous(expand = c(0, 0), breaks = c(5, 10, 15,20)) +
scale_y_continuous(limits = c(0,7.5)) +
geom_hline(yintercept = 5.47, linetype = "dashed") +
scale_linetype_manual(values = c("BF" = 1)) +
labs(x = "Genomic Position (Mb)", y = expression(-log[10](italic(p)))) +
#labs(title = "Progress: {frame} of {nframes}") +
theme(legend.position = "none", panel.grid = element_blank()) +
facet_grid(. ~ CHROM, scales = "free_x", space = facet_scales)
IVsub <- read_csv("sample_data.csv") %>%
dplyr::group_by(marker,CHROM,POS,A1,A2,AF1,BETA,SE,P,log10p,trait,BF,aboveBF,sig)%>%
nest() %>%
ungroup()
IVsub %>%
ggplot() +
theme_bw() +
aes(group = POS) +
geom_point(mapping = aes(x = POS, y = log10p, color = sig, alpha = sig)) +
scale_alpha_manual(values = c("BF" = 1,  "user" = 1, "NONSIG" = 0.25)) +
scale_colour_manual(values = sig.colors) +
scale_x_continuous(expand = c(0, 0), breaks = c(5, 10, 15,20)) +
scale_y_continuous(limits = c(0,7.5)) +
geom_hline(yintercept = 5.47, linetype = "dashed") +
scale_linetype_manual(values = c("BF" = 1)) +
labs(x = "Genomic Position (Mb)", y = expression(-log[10](italic(p)))) +
#labs(title = "Progress: {frame} of {nframes}") +
theme(legend.position = "none", panel.grid = element_blank()) +
facet_grid(. ~ CHROM, scales = "free_x", space = facet_scales)
IVsub <- read_csv("sample_data.csv") %>%
dplyr::group_by(marker,CHROM,POS,A1,A2,AF1,BETA,SE,P,log10p,trait,BF,aboveBF,sig)%>%
nest() %>%
ungroup()
IVsub %>%
ggplot() +
theme_bw() +
aes(group = POS) +
geom_point(mapping = aes(x = POS, y = log10p, color = sig, alpha = sig)) +
scale_alpha_manual(values = c("BF" = 1,  "user" = 1, "NONSIG" = 0.25)) +
scale_colour_manual(values = sig.colors) +
scale_x_continuous(expand = c(0, 0), breaks = c(5, 10, 15,20)) +
scale_y_continuous(limits = c(0,7.5)) +
geom_hline(yintercept = 5.47, linetype = "dashed") +
scale_linetype_manual(values = c("BF" = 1)) +
labs(x = "Genomic Position (Mb)", y = expression(-log[10](italic(p)))) +
#labs(title = "Progress: {frame} of {nframes}") +
theme(legend.position = "none", panel.grid = element_blank()) +
facet_grid(. ~ CHROM, scales = "free_x", space = facet_scales)
IVsub <- read_csv("sample_data.csv") %>%
dplyr::group_by(marker,CHROM,POS,A1,A2,AF1,BETA,SE,P,log10p,trait,BF,aboveBF,sig)%>%
nest() %>%
ungroup()
IVsub %>%
ggplot() +
theme_bw() +
aes(group = POS) +
geom_point(mapping = aes(x = POS, y = log10p, color = sig, alpha = sig)) +
scale_alpha_manual(values = c("BF" = 1,  "user" = 1, "NONSIG" = 0.25)) +
scale_colour_manual(values = sig.colors) +
scale_x_continuous(expand = c(0, 0), breaks = c(5, 10, 15,20)) +
scale_y_continuous(limits = c(0,7.5)) +
geom_hline(yintercept = 5.47, linetype = "dashed") +
scale_linetype_manual(values = c("BF" = 1)) +
labs(x = "Genomic Position (Mb)", y = expression(-log[10](italic(p)))) +
#labs(title = "Progress: {frame} of {nframes}") +
theme(legend.position = "none", panel.grid = element_blank()) +
facet_grid(. ~ CHROM, scales = "free_x", space = facet_scales)
IVsub <- read_csv("sample_data.csv") %>%
dplyr::group_by(marker,CHROM,POS,A1,A2,AF1,BETA,SE,P,log10p,trait,BF,aboveBF,sig)%>%
nest() %>%
ungroup()
IVsub %>%
ggplot() +
theme_bw() +
aes(group = POS) +
geom_point(mapping = aes(x = POS, y = log10p, color = sig, alpha = sig)) +
scale_alpha_manual(values = c("BF" = 1,  "user" = 1, "NONSIG" = 0.25)) +
scale_colour_manual(values = sig.colors) +
scale_x_continuous(expand = c(0, 0), breaks = c(5, 10, 15,20)) +
scale_y_continuous(limits = c(0,7.5)) +
geom_hline(yintercept = 5.47, linetype = "dashed") +
scale_linetype_manual(values = c("BF" = 1)) +
labs(x = "Genomic Position (Mb)", y = expression(-log[10](italic(p)))) +
#labs(title = "Progress: {frame} of {nframes}") +
theme(legend.position = "none", panel.grid = element_blank()) +
facet_grid(. ~ CHROM, scales = "free_x", space = facet_scales)
# manhattan
chrIV <- IVsub %>%
ggplot() +
theme_bw() +
aes(group = POS) +
geom_point(mapping = aes(x = POS, y = log10p, color = sig, alpha = sig)) +
scale_alpha_manual(values = c("BF" = 1,  "user" = 1, "NONSIG" = 0.25)) +
scale_colour_manual(values = sig.colors) +
scale_x_continuous(expand = c(0, 0), breaks = c(5, 10, 15,20)) +
scale_y_continuous(limits = c(0,7.5)) +
geom_hline(yintercept = 5.47, linetype = "dashed") +
scale_linetype_manual(values = c("BF" = 1)) +
labs(x = "Genomic Position (Mb)", y = expression(-log[10](italic(p)))) +
#labs(title = "Progress: {frame} of {nframes}") +
theme(legend.position = "none", panel.grid = element_blank()) +
facet_grid(. ~ CHROM, scales = "free_x", space = facet_scales) +
transition_manual(POS, cumulative = TRUE) #+
animate(chrIV, nframes=nrow(IVsub), duration = 15, height = 4, width = 6, units = "in", res = 300)
IVsub %>%
ggplot() +
theme_bw() +
aes(group = POS) +
geom_point(mapping = aes(x = POS, y = log10p, color = sig, alpha = sig)) +
scale_alpha_manual(values = c("BF" = 1,  "user" = 1, "NONSIG" = 0.25)) +
scale_colour_manual(values = sig.colors) +
scale_x_continuous(expand = c(0, 0), breaks = c(1, 2, 3, 4, 5, 10, 15,20)) +
scale_y_continuous(limits = c(0,7.5)) +
geom_hline(yintercept = 5.47, linetype = "dashed") +
scale_linetype_manual(values = c("BF" = 1)) +
labs(x = "Genomic Position (Mb)", y = expression(-log[10](italic(p)))) +
#labs(title = "Progress: {frame} of {nframes}") +
theme(legend.position = "none", panel.grid = element_blank()) +
facet_grid(. ~ CHROM, scales = "free_x", space = facet_scales)
IVsub <- read_csv("sample_data.csv") %>%
dplyr::group_by(marker,CHROM,POS,A1,A2,AF1,BETA,SE,P,log10p,trait,BF,aboveBF,sig)%>%
nest() %>%
ungroup()
IVsub %>%
ggplot() +
theme_bw() +
aes(group = POS) +
geom_point(mapping = aes(x = POS, y = log10p, color = sig, alpha = sig)) +
scale_alpha_manual(values = c("BF" = 1,  "user" = 1, "NONSIG" = 0.25)) +
scale_colour_manual(values = sig.colors) +
scale_x_continuous(expand = c(0, 0), breaks = c(1, 2, 3, 4, 5, 10, 15,20)) +
scale_y_continuous(limits = c(0,7.5)) +
geom_hline(yintercept = 5.47, linetype = "dashed") +
scale_linetype_manual(values = c("BF" = 1)) +
labs(x = "Genomic Position (Mb)", y = expression(-log[10](italic(p)))) +
#labs(title = "Progress: {frame} of {nframes}") +
theme(legend.position = "none", panel.grid = element_blank()) +
facet_grid(. ~ CHROM, scales = "free_x", space = facet_scales)
IVsub <- read_csv("sample_data.csv") %>%
dplyr::group_by(marker,CHROM,POS,A1,A2,AF1,BETA,SE,P,log10p,trait,BF,aboveBF,sig)%>%
nest() %>%
ungroup()
IVsub %>%
ggplot() +
theme_bw() +
aes(group = POS) +
geom_point(mapping = aes(x = POS, y = log10p, color = sig, alpha = sig)) +
scale_alpha_manual(values = c("BF" = 1,  "user" = 1, "NONSIG" = 0.25)) +
scale_colour_manual(values = sig.colors) +
scale_x_continuous(expand = c(0, 0), breaks = c(5, 10, 15,16, 17, 18, 19, 20)) +
scale_y_continuous(limits = c(0,7.5)) +
geom_hline(yintercept = 5.47, linetype = "dashed") +
scale_linetype_manual(values = c("BF" = 1)) +
labs(x = "Genomic Position (Mb)", y = expression(-log[10](italic(p)))) +
#labs(title = "Progress: {frame} of {nframes}") +
theme(legend.position = "none", panel.grid = element_blank()) +
facet_grid(. ~ CHROM, scales = "free_x", space = facet_scales)
IVsub <- read_csv("sample_data.csv") %>%
dplyr::group_by(marker,CHROM,POS,A1,A2,AF1,BETA,SE,P,log10p,trait,BF,aboveBF,sig)%>%
nest() %>%
ungroup()
IVsub %>%
ggplot() +
theme_bw() +
aes(group = POS) +
geom_point(mapping = aes(x = POS, y = log10p, color = sig, alpha = sig)) +
scale_alpha_manual(values = c("BF" = 1,  "user" = 1, "NONSIG" = 0.25)) +
scale_colour_manual(values = sig.colors) +
scale_x_continuous(expand = c(0, 0), breaks = c(5, 10, 15,16, 17, 18, 19, 20)) +
scale_y_continuous(limits = c(0,7.5)) +
geom_hline(yintercept = 5.47, linetype = "dashed") +
scale_linetype_manual(values = c("BF" = 1)) +
labs(x = "Genomic Position (Mb)", y = expression(-log[10](italic(p)))) +
#labs(title = "Progress: {frame} of {nframes}") +
theme(legend.position = "none", panel.grid = element_blank()) +
facet_grid(. ~ CHROM, scales = "free_x", space = facet_scales)
# manhattan
chrIV <- IVsub %>%
ggplot() +
theme_bw() +
aes(group = POS) +
geom_point(mapping = aes(x = POS, y = log10p, color = sig, alpha = sig)) +
scale_alpha_manual(values = c("BF" = 1,  "user" = 1, "NONSIG" = 0.25)) +
scale_colour_manual(values = sig.colors) +
scale_x_continuous(expand = c(0, 0), breaks = c(5, 10, 15,16, 17, 18, 19, 20)) +
scale_y_continuous(limits = c(0,7.5)) +
geom_hline(yintercept = 5.47, linetype = "dashed") +
scale_linetype_manual(values = c("BF" = 1)) +
labs(x = "Genomic Position (Mb)", y = expression(-log[10](italic(p)))) +
#labs(title = "Progress: {frame} of {nframes}") +
theme(legend.position = "none", panel.grid = element_blank()) +
facet_grid(. ~ CHROM, scales = "free_x", space = facet_scales) +
transition_manual(POS, cumulative = TRUE) #+
animate(chrIV, nframes=nrow(IVsub), duration = 15, height = 4, width = 6, units = "in", res = 300)
IVsub <- read_csv("sample_data.csv") %>%
dplyr::group_by(marker,CHROM,POS,A1,A2,AF1,BETA,SE,P,log10p,trait,BF,aboveBF,sig)%>%
nest() %>%
ungroup()
IVsub %>%
ggplot() +
theme_bw() +
aes(group = POS) +
geom_point(mapping = aes(x = POS, y = log10p, color = sig, alpha = sig)) +
scale_alpha_manual(values = c("BF" = 1,  "user" = 1, "NONSIG" = 0.25)) +
scale_colour_manual(values = sig.colors) +
scale_x_continuous(expand = c(0, 0), breaks = c(5, 10, 15,16, 17, 18, 19, 20)) +
scale_y_continuous(limits = c(0,7.5)) +
geom_hline(yintercept = 5.47, linetype = "dashed") +
scale_linetype_manual(values = c("BF" = 1)) +
labs(x = "Genomic Position (Mb)", y = expression(-log[10](italic(p)))) +
#labs(title = "Progress: {frame} of {nframes}") +
theme(legend.position = "none", panel.grid = element_blank()) +
facet_grid(. ~ CHROM, scales = "free_x", space = facet_scales)
animate(chrIV, nframes=nrow(IVsub), duration = 15, height = 4, width = 6, units = "in", res = 300)
IVsub <- read_csv("sample_data.csv") %>%
dplyr::group_by(marker,CHROM,POS,A1,A2,AF1,BETA,SE,P,log10p,trait,BF,aboveBF,sig)%>%
nest() %>%
ungroup()
IVsub %>%
ggplot() +
theme_bw() +
aes(group = POS) +
geom_point(mapping = aes(x = POS, y = log10p, color = sig, alpha = sig)) +
scale_alpha_manual(values = c("BF" = 1,  "user" = 1, "NONSIG" = 0.25)) +
scale_colour_manual(values = sig.colors) +
scale_x_continuous(expand = c(0, 0), breaks = c(5, 10, 15,16, 17, 18, 19, 20)) +
scale_y_continuous(limits = c(0,7.5)) +
geom_hline(yintercept = 5.47, linetype = "dashed") +
scale_linetype_manual(values = c("BF" = 1)) +
labs(x = "Genomic Position (Mb)", y = expression(-log[10](italic(p)))) +
#labs(title = "Progress: {frame} of {nframes}") +
theme(legend.position = "none", panel.grid = element_blank()) +
facet_grid(. ~ CHROM, scales = "free_x", space = facet_scales)
IVsub <- read_csv("sample_data.csv") %>%
dplyr::group_by(marker,CHROM,POS,A1,A2,AF1,BETA,SE,P,log10p,trait,BF,aboveBF,sig)%>%
nest() %>%
ungroup()
IVsub %>%
ggplot() +
theme_bw() +
aes(group = POS) +
geom_point(mapping = aes(x = POS, y = log10p, color = sig, alpha = sig)) +
scale_alpha_manual(values = c("BF" = 1,  "user" = 1, "NONSIG" = 0.25)) +
scale_colour_manual(values = sig.colors) +
scale_x_continuous(expand = c(0, 0), breaks = c(5, 10, 15,16, 17, 18, 19, 20)) +
scale_y_continuous(limits = c(0,7.5)) +
geom_hline(yintercept = 5.47, linetype = "dashed") +
scale_linetype_manual(values = c("BF" = 1)) +
labs(x = "Genomic Position (Mb)", y = expression(-log[10](italic(p)))) +
#labs(title = "Progress: {frame} of {nframes}") +
theme(legend.position = "none", panel.grid = element_blank()) +
facet_grid(. ~ CHROM, scales = "free_x", space = facet_scales)
# manhattan
chrIV <- IVsub %>%
ggplot() +
theme_bw() +
aes(group = POS) +
geom_point(mapping = aes(x = POS, y = log10p, color = sig, alpha = sig)) +
scale_alpha_manual(values = c("BF" = 1,  "user" = 1, "NONSIG" = 0.25)) +
scale_colour_manual(values = sig.colors) +
scale_x_continuous(expand = c(0, 0), breaks = c(5, 10, 15,16, 17, 18, 19, 20)) +
scale_y_continuous(limits = c(0,7.5)) +
geom_hline(yintercept = 5.47, linetype = "dashed") +
scale_linetype_manual(values = c("BF" = 1)) +
labs(x = "Genomic Position (Mb)", y = expression(-log[10](italic(p)))) +
#labs(title = "Progress: {frame} of {nframes}") +
theme(legend.position = "none", panel.grid = element_blank()) +
facet_grid(. ~ CHROM, scales = "free_x", space = facet_scales) +
transition_manual(POS, cumulative = TRUE) #+
animate(chrIV, nframes=nrow(IVsub), duration = 15, height = 4, width = 6, units = "in", res = 300)
# manhattan
chrIV <- IVsub %>%
ggplot() +
theme_bw() +
aes(group = POS) +
geom_point(mapping = aes(x = POS, y = log10p, color = sig, alpha = sig)) +
scale_alpha_manual(values = c("BF" = 1,  "user" = 1, "NONSIG" = 0.25)) +
scale_colour_manual(values = sig.colors) +
scale_x_continuous(expand = c(0, 0), breaks = c(5, 10, 15, 20)) +
scale_y_continuous(limits = c(0,7.5)) +
geom_hline(yintercept = 5.47, linetype = "dashed") +
scale_linetype_manual(values = c("BF" = 1)) +
labs(x = "Genomic Position (Mb)", y = expression(-log[10](italic(p)))) +
#labs(title = "Progress: {frame} of {nframes}") +
theme(legend.position = "none", panel.grid = element_blank()) +
facet_grid(. ~ CHROM, scales = "free_x", space = facet_scales) +
transition_manual(POS, cumulative = TRUE) #+
animate(chrIV, nframes=nrow(IVsub), duration = 15, height = 4, width = 6, units = "in", res = 300)
anim_save("ChrIV_man.gif")
# phenotype x genotype
chrIVpxg <- IVsub %>%
unnest(cols = c(data)) %>%
ggplot() +
theme_bw() +
aes(x = allele, y = value) +
geom_jitter(aes(color = sig), width = 0.2, shape = 21) +
geom_boxplot(aes(color = sig), alpha = 0.4, outlier.alpha = 0) +
scale_color_manual(values = sig.colors) +
guides(color = "none") +
theme(legend.position = "bottom") +
labs(x = "Genotype", y = "Trait Value") +
facet_grid(. ~ CHROM) +
scale_y_continuous(limits = c(-3.5,3.5)) +
scale_x_discrete(breaks = c("REF", "ALT")) +
#transition_reveal(POS)
transition_manual(POS)
animate(chrIVpxg, nframes=nrow(IVsub), duration = 15, height = 4, width = 3, units = "in", res = 300)
IVsub <- read_csv("sample_data.csv") %>%
dplyr::group_by(marker,CHROM,POS,A1,A2,AF1,BETA,SE,P,log10p,trait,BF,aboveBF,sig)%>%
nest() %>%
ungroup()
IVsub %>%
ggplot() +
theme_bw() +
aes(group = POS) +
geom_point(mapping = aes(x = POS, y = log10p, color = sig, alpha = sig)) +
scale_alpha_manual(values = c("BF" = 1,  "user" = 1, "NONSIG" = 0.25)) +
scale_colour_manual(values = sig.colors) +
scale_x_continuous(expand = c(0, 0), breaks = c(5, 10, 15, 20)) +
scale_y_continuous(limits = c(0,7.5)) +
geom_hline(yintercept = 5.47, linetype = "dashed") +
scale_linetype_manual(values = c("BF" = 1)) +
labs(x = "Genomic Position (Mb)", y = expression(-log[10](italic(p)))) +
#labs(title = "Progress: {frame} of {nframes}") +
theme(legend.position = "none", panel.grid = element_blank()) +
facet_grid(. ~ CHROM, scales = "free_x", space = facet_scales)
IVsub %>%
ggplot() +
theme_bw() +
aes(group = POS) +
geom_point(mapping = aes(x = POS, y = log10p, color = sig, alpha = sig)) +
scale_alpha_manual(values = c("BF" = 1,  "user" = 1, "NONSIG" = 0.25)) +
scale_colour_manual(values = sig.colors) +
scale_x_continuous(expand = c(0, 0), breaks = c(5, 10, 11,12,13,14, 15, 20)) +
scale_y_continuous(limits = c(0,7.5)) +
geom_hline(yintercept = 5.47, linetype = "dashed") +
scale_linetype_manual(values = c("BF" = 1)) +
labs(x = "Genomic Position (Mb)", y = expression(-log[10](italic(p)))) +
#labs(title = "Progress: {frame} of {nframes}") +
theme(legend.position = "none", panel.grid = element_blank()) +
facet_grid(. ~ CHROM, scales = "free_x", space = facet_scales)
IVsub <- read_csv("sample_data.csv") %>%
dplyr::group_by(marker,CHROM,POS,A1,A2,AF1,BETA,SE,P,log10p,trait,BF,aboveBF,sig)%>%
nest() %>%
ungroup()
IVsub %>%
ggplot() +
theme_bw() +
aes(group = POS) +
geom_point(mapping = aes(x = POS, y = log10p, color = sig, alpha = sig)) +
scale_alpha_manual(values = c("BF" = 1,  "user" = 1, "NONSIG" = 0.25)) +
scale_colour_manual(values = sig.colors) +
scale_x_continuous(expand = c(0, 0), breaks = c(5, 10, 11,12,13,14, 15, 20)) +
scale_y_continuous(limits = c(0,7.5)) +
geom_hline(yintercept = 5.47, linetype = "dashed") +
scale_linetype_manual(values = c("BF" = 1)) +
labs(x = "Genomic Position (Mb)", y = expression(-log[10](italic(p)))) +
#labs(title = "Progress: {frame} of {nframes}") +
theme(legend.position = "none", panel.grid = element_blank()) +
facet_grid(. ~ CHROM, scales = "free_x", space = facet_scales)
# manhattan
chrIV <- IVsub %>%
ggplot() +
theme_bw() +
aes(group = POS) +
geom_point(mapping = aes(x = POS, y = log10p, color = sig, alpha = sig)) +
scale_alpha_manual(values = c("BF" = 1,  "user" = 1, "NONSIG" = 0.25)) +
scale_colour_manual(values = sig.colors) +
scale_x_continuous(expand = c(0, 0), breaks = c(5, 10,15, 20)) +
scale_y_continuous(limits = c(0,7.5)) +
geom_hline(yintercept = 5.47, linetype = "dashed") +
scale_linetype_manual(values = c("BF" = 1)) +
labs(x = "Genomic Position (Mb)", y = expression(-log[10](italic(p)))) +
#labs(title = "Progress: {frame} of {nframes}") +
theme(legend.position = "none", panel.grid = element_blank()) +
facet_grid(. ~ CHROM, scales = "free_x", space = facet_scales) +
transition_manual(POS, cumulative = TRUE) #+
animate(chrIV, nframes=nrow(IVsub), duration = 15, height = 4, width = 6, units = "in", res = 300)
animate(chrIV, nframes=nrow(IVsub), duration = 20, height = 4, width = 6, units = "in", res = 300)
anim_save("ChrIV_man.gif")
# phenotype x genotype
chrIVpxg <- IVsub %>%
unnest(cols = c(data)) %>%
ggplot() +
theme_bw() +
aes(x = allele, y = value) +
geom_jitter(aes(color = sig), width = 0.2, shape = 21) +
geom_boxplot(aes(color = sig), alpha = 0.4, outlier.alpha = 0) +
scale_color_manual(values = sig.colors) +
guides(color = "none") +
theme(legend.position = "bottom") +
labs(x = "Genotype", y = "Trait Value") +
facet_grid(. ~ CHROM) +
scale_y_continuous(limits = c(-3.5,3.5)) +
scale_x_discrete(breaks = c("REF", "ALT")) +
#transition_reveal(POS)
transition_manual(POS)
animate(chrIVpxg, nframes=nrow(IVsub), duration = 15, height = 4, width = 3, units = "in", res = 300)
anim_save("ChrIV_pxg.gif")
animate(chrIVpxg, nframes=nrow(IVsub), duration = 20, height = 4, width = 3, units = "in", res = 300)
anim_save("ChrIV_pxg.gif")
# manhattan
chrIV <- IVsub %>%
ggplot() +
theme_bw() +
aes(group = POS) +
geom_point(mapping = aes(x = POS, y = log10p, color = sig, alpha = sig)) +
scale_alpha_manual(values = c("BF" = 1,  "user" = 1, "NONSIG" = 0.25)) +
scale_colour_manual(values = sig.colors) +
scale_x_continuous(expand = c(0, 0), breaks = c(5, 10,15, 20)) +
scale_y_continuous(limits = c(0,7.5)) +
geom_hline(yintercept = 5.47, linetype = "dashed") +
scale_linetype_manual(values = c("BF" = 1)) +
labs(x = "Genomic Position (Mb)", y = expression(-log[10](italic(p)))) +
#labs(title = "Progress: {frame} of {nframes}") +
theme(legend.position = "none", panel.grid = element_blank()) +
facet_grid(. ~ CHROM, scales = "free_x", space = facet_scales) +
transition_manual(POS, cumulative = TRUE) #+
animate(chrIV, nframes=nrow(IVsub), duration = 20, height = 4, width = 6, units = "in", res = 300)
View(IVsub)
anim_save("ChrIV_man.gif")
anim_save("ChrIV_man.gif")
anim_save("ChrIV_man.gif")
anim_save("ChrIV_man.gif")
